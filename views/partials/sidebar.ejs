<% const active = typeof activePage !== 'undefined' ? activePage : ''; %>
<aside class="sidebar" id="sidebar" aria-label="Menu">
  <div class="sidebar__head">
    <a href="/dashboard" class="sidebar__brand">
      <span class="sidebar__icon sidebar__icon--logo" aria-hidden="true">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/></svg>
      </span>
      <span class="sidebar__brand-text">Portal-01</span>
    </a>
    <button type="button" class="sidebar__close" id="sidebarClose" aria-label="Chiudi menu">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
  </div>
  <nav class="sidebar__nav">
    <a href="/dashboard" class="sidebar__link <%= active === 'dashboard' ? 'sidebar__link--active' : '' %>">
      <span class="sidebar__icon" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
      </span>
      <span class="sidebar__label">Dashboard</span>
    </a>
    <a href="/ferie" class="sidebar__link <%= active === 'ferie' ? 'sidebar__link--active' : '' %>">
      <span class="sidebar__icon" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
      </span>
      <span class="sidebar__label">Ferie</span>
    </a>
    <% if (user && user.role === 'admin') { %>
    <a href="/admin/users" class="sidebar__link <%= active === 'admin' ? 'sidebar__link--active' : '' %>">
      <span class="sidebar__icon" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
      </span>
      <span class="sidebar__label">Utenti</span>
    </a>
    <% } %>
    <a href="/profile" class="sidebar__link <%= active === 'profile' ? 'sidebar__link--active' : '' %>">
      <span class="sidebar__icon" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
      </span>
      <span class="sidebar__label">Profilo</span>
    </a>
  </nav>
  <div class="sidebar__foot">
    <% if (user) { %>
    <p class="sidebar__user"><%= user.full_name %></p>
    <% } %>
    <a href="/auth/logout" class="sidebar__link sidebar__link--logout">
      <span class="sidebar__icon" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
      </span>
      <span class="sidebar__label">Esci</span>
    </a>
  </div>
</aside>
<button type="button" class="sidebar__toggle" id="sidebarToggle" aria-label="Apri menu">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
</button>
<div class="sidebar__backdrop" id="sidebarBackdrop" aria-hidden="true"></div>
<script>
(function() {
  var sidebar = document.getElementById('sidebar');
  var toggle = document.getElementById('sidebarToggle');
  var closeBtn = document.getElementById('sidebarClose');
  var backdrop = document.getElementById('sidebarBackdrop');
  if (!sidebar || !toggle) return;
  function open() { sidebar.classList.add('is-open'); if (backdrop) backdrop.classList.add('is-open'); }
  function close() { sidebar.classList.remove('is-open'); if (backdrop) backdrop.classList.remove('is-open'); }
  toggle.addEventListener('click', open);
  if (closeBtn) closeBtn.addEventListener('click', close);
  if (backdrop) backdrop.addEventListener('click', close);
})();
</script>
